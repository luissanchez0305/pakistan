(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{iVZY:function(e,t,r){"use strict";r.d(t,"a",function(){return O}),r.d(t,"b",function(){return k});var o=r("OvAC"),n=r.n(o),s=r("nxTg"),a=r.n(s),i=r("SDJZ"),c=r.n(i),u=r("NToG"),p=r.n(u),l=r("czhI"),d=r.n(l);function h(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,o)}return r}function y(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?h(Object(r),!0).forEach(function(t){n()(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var f="/platform/topology/v6",v="fx",g="bo",w="otp",m="mt",k=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.url,o=t.onDomainError,n=t.webViewType;c()(this,e),this.url=r||f,this.onDomainError=o,this.webViewType=n}return p()(e,[{key:"set",value:function(e,t){var r=window.location,o=r.hostname,n=r.protocol,s="".concat(n,"//").concat(o),a=e.find(function(e){return!!e.otp.index&&e.otp.index.url===s});a||(a=e[0],t&&t(new Error("topology for current host not found"))),this.topology=a,this.otp=a[w],this.bo=a[g],this.fx=a[v],this.mt=a[m],this.services=a.services}},{key:"isNeedLoadTopology",value:function(e){return e||!this.topologyLoadedCache}},{key:"request",value:function(){var e=this.webViewType?"".concat(this.url,"?app=").concat(this.webViewType):this.url;return d()({method:"get",url:e,withCredentials:!0,params:{fallback_domain:0}})}},{key:"load",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{isForceLoad:!1};return this.isNeedLoadTopology(t.isForceLoad)?(this.topologyLoadedCache=this.request().then(function(t){var r=t.data;return e.set(r,e.onDomainError),r}),this.topologyLoadedCache.then(function(){return e.topology})):this.topologyLoadedCache.then(function(t){return e.set(t),e.topology})}},{key:"topologyLoadedCache",get:function(){return window.__topologyCache__&&window.__topologyCache__[this.url]},set:function(e){window.__topologyCache__||(window.__topologyCache__={}),window.__topologyCache__[this.url]=e}}]),e}();function b(e){var t=document.cookie.match(new RegExp("(?:^|; )".concat(e.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1"),"=([^;]*)")))||[],r=a()(t,2)[1];if(r){r=decodeURIComponent(r);try{return JSON.parse(r)}catch(e){}return r}}var O=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};c()(this,e),e.axios=d.a.create(),e.axios.interceptors.response.use(void 0,e.errorInterceptor),this.topology=t.topology||new k,this.defaultHeaders=e.getHeaders(t.headers)}return p()(e,[{key:"composeHeaders",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r={"X-Request-Project":"".concat(e)};return y({},this.defaultHeaders,{},r,{},t)}},{key:"request",value:function(t,r,o){var n=this;e.checkOptions(o),o.headers=this.composeHeaders(o.project,o.headers);var s=o.data,a=o.version,i=o.params,c=o.headers,u=o.cancelToken;return this.topology.load().then(function(){var o={method:r,data:s,params:i,headers:c,cancelToken:u};return void 0===o.cancelToken&&delete o.cancelToken,e.axios.request(y({},o,{url:function(e,t,r){var o=t,n=e;return"/"!==String.prototype.charAt.call(t,0)&&(o="/".concat(t)),"/"!==String.prototype.slice.call(e,-1)&&(n="".concat(e,"/")),"".concat(n).concat(r).concat(o)}(n.topology.otp.api.url,t,a),withCredentials:!0})).then(e.handleSuccessResponse).catch(e.handleErrorResponse)})}},{key:"post",value:function(e,t){return this.request(e,"post",t)}},{key:"get",value:function(e,t){return this.request(e,"get",t)}}],[{key:"checkOptions",value:function(e){if(!(e&&e.version&&e.project))throw new Error('"request" method of Http was called without required fields in "options" parameter!\n        ("version" or "project" is missing)"');return null}},{key:"getIosHeaders",value:function(){var e=b("X-App-Name"),t=b("X-App-Version");return e&&t?{"X-App-Name":e,"X-App-Version":t}:null}},{key:"getHeaders",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.getIosHeaders();return Object.assign({},{"X-Request-Type":"Api-Request","X-Requested-With":"XMLHttpRequest","Content-Type":"application/json"},y({},t),r)}},{key:"errorInterceptor",value:function(e){return e.response&&401!==e.response.status?Promise.reject(e):e&&e.toString().includes("Network Error")?(e.response={},e.response.data={type:"network_error"},Promise.reject(e)):Promise.reject(e)}},{key:"handleSuccessResponse",value:function(e){return Promise.resolve(function(e){var t=e.data;return 204===e.status?null:t.data}(e))}},{key:"handleErrorResponse",value:function(e){var t=function(e){if(d.a.isCancel(e))return{code:"Error",internal_code:"error",msg:"Request is canceled by cancel token",type:"Canceled Error",raw:{error:e,status:null}};var t={code:"Error",internal_code:"error",msg:"System error",type:"Error",raw:{}};if(e.response){var r=e.response,o=r.data,n={status:r.status,error:e.response},s=o&&o.errors;Array.isArray(s)&&s[0]?Object.assign(t,s[0],{raw:n}):o.type&&Object.assign(t,{type:o.type||"Error",raw:n})}return t}(e);return Promise.reject(t)}}]),e}()}}]);